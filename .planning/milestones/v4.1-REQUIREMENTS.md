# Requirements Archive: v4.1 Server & Transport Layer

**Archived:** 2026-02-04
**Status:** SHIPPED

This is the archived requirements specification for v4.1.
For current requirements, see `.planning/REQUIREMENTS.md` (created for next milestone).

---

# Requirements: gaz

**Defined:** 2026-02-03
**Core Value:** Simple, type-safe dependency injection with sane defaults

## v4.1 Requirements

**Milestone:** v4.1 Server & Transport Layer
**Goal:** Implement production-ready HTTP and gRPC server capabilities with a unified Gateway pattern.

### Core Framework

- [x] **CORE-01**: Container supports resolving all providers of type T (`di.List[T]`) for discovery

### Transport Layer

- [x] **TRN-01**: HTTP Server with configurable timeouts (Read/Write/Idle/Header)
- [x] **TRN-02**: gRPC Server with Interceptors (logging, recovery, OTEL)
- [x] **TRN-03**: gRPC Reflection enabled by default

### Gateway Integration

- [x] **GW-01**: Gateway runs on separate HTTP port (no cmux)
- [x] **GW-02**: Connects to gRPC via loopback client
- [x] **GW-03**: Dynamic registration of services via DI interface (`Registrar`)
- [x] **GW-04**: CORS support (Origins, Methods, Headers)

### Infrastructure

- [x] **INF-01**: PGX health check (`jackc/pgx`)
- [x] **INF-02**: gRPC health check
- [x] **INF-03**: OpenTelemetry instrumentation

## Out of Scope

| Feature | Reason |
|---------|--------|
| cmux / Single Port | Research indicates fragility and K8s ingress issues |
| HTTP/3 (QUIC) | Defer to future due to library maturity |
| Distributed Rate Limiting | Requires external store (Redis), out of scope for core |

## Traceability

| Requirement | Phase | Status |
|-------------|-------|--------|
| CORE-01 | Phase 37 | Complete |
| TRN-01 | Phase 38 | Complete |
| TRN-02 | Phase 38 | Complete |
| TRN-03 | Phase 38 | Complete |
| GW-01 | Phase 38 | Complete |
| GW-02 | Phase 39 | Complete |
| GW-03 | Phase 39 | Complete |
| GW-04 | Phase 39 | Complete |
| INF-01 | Phase 40 | Complete |
| INF-02 | Phase 40 | Complete |
| INF-03 | Phase 40 | Complete |

**Coverage:**
- v4.1 requirements: 11 total
- Shipped: 11 (100%)
- Dropped: 0

---

## Milestone Summary

**Shipped:** 11 of 11 v4.1 requirements (100%)
**Adjusted:** None
**Dropped:** None

All requirements were implemented as originally specified.

---
*Archived: 2026-02-04 as part of v4.1 milestone completion*
