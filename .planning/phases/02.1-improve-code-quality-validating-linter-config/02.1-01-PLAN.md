---
phase: 02.1-improve-code-quality
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .golangci.yml
  - app.go
  - container.go
  - container_graph_test.go
  - container_test.go
  - inject.go
  - inject_test.go
  - lifecycle_engine_test.go
  - registration.go
  - resolution.go
  - service.go
  - types.go
autonomous: true

must_haves:
  truths:
    - "testpackage linter is disabled (tests need internal access)"
    - "All godot, golines, gofumpt formatting issues are auto-fixed"
    - "ireturn and gocognit issues are excluded via nolint or config"
  artifacts:
    - path: ".golangci.yml"
      provides: "Updated linter configuration"
      contains: "testpackage"
    - path: "app.go"
      provides: "Package comment added"
      contains: "Package gaz"
  key_links:
    - from: ".golangci.yml"
      to: "make lint"
      via: "golangci-lint configuration"
      pattern: "testpackage"
---

<objective>
Configure linter and auto-fix formatting issues

Purpose: Reduce lint issue count from 211 to ~100 by fixing config and auto-formatting
Output: Updated .golangci.yml with testpackage disabled, all files formatted
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.golangci.yml
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update linter config and run auto-format</name>
  <files>.golangci.yml</files>
  <action>
1. Disable testpackage linter in .golangci.yml:
   - Add `- testpackage` to the `linters.disable` section (or remove from enable)
   - Reason: Tests need internal package access to test unexported functionality

2. Add exclusion rules for intentional patterns:
   - Add to exclusions.rules:
     ```yaml
     - linters: [ireturn]
       path: resolution\.go
       text: "returns generic interface"
     - linters: [gocognit]
       path: lifecycle_engine\.go
       text: "cognitive complexity"
     ```

3. Run `make fmt` to auto-fix:
   - godot (20 issues): Comments ending in period
   - golines (5 issues): Line length
   - gofumpt (2 issues): Formatting
  </action>
  <verify>Run `make lint 2>&1 | grep -E "(testpackage|godot|golines|gofumpt|ireturn|gocognit)" | wc -l` returns 0 or much lower</verify>
  <done>testpackage, godot, golines, gofumpt, ireturn, gocognit issues eliminated (~35 issues fixed)</done>
</task>

<task type="auto">
  <name>Task 2: Add package comment to app.go</name>
  <files>app.go</files>
  <action>
Add package comment at the top of app.go (after any build tags, before package declaration):

```go
// Package gaz provides a simple, type-safe dependency injection container
// with lifecycle management for Go applications.
package gaz
```

This fixes the revive package-comments warning.
  </action>
  <verify>Run `make lint 2>&1 | grep "package-comments"` returns nothing</verify>
  <done>Package comment added, package-comments warning resolved</done>
</task>

</tasks>

<verification>
```bash
# Count remaining issues (should be ~100 fewer)
make lint 2>&1 | tail -5

# Verify specific categories resolved
make lint 2>&1 | grep -c "testpackage" # Should be 0
make lint 2>&1 | grep -c "godot" # Should be 0
make lint 2>&1 | grep -c "package-comments" # Should be 0
```
</verification>

<success_criteria>
- [ ] testpackage linter disabled (9 issues gone)
- [ ] godot issues auto-fixed by make fmt (20 issues gone)
- [ ] golines issues auto-fixed (5 issues gone)
- [ ] gofumpt issues auto-fixed (2 issues gone)
- [ ] ireturn excluded for resolution.go (1 issue gone)
- [ ] gocognit excluded for lifecycle_engine.go (1 issue gone)
- [ ] Package comment added to app.go (1 issue gone)
- [ ] Total: ~39 issues resolved
</success_criteria>

<output>
After completion, create `.planning/phases/02.1-improve-code-quality-validating-linter-config/02.1-01-SUMMARY.md`
</output>
