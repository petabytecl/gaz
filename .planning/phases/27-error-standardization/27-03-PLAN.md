---
phase: 27-error-standardization
plan: 03
type: execute
wave: 2
depends_on: ["27-01"]
files_modified:
  - config/errors.go
  - config/manager.go
  - config/validation.go
  - config/viper/backend.go
autonomous: true

must_haves:
  truths:
    - "config package no longer defines its own sentinel errors"
    - "All config package code imports gaz and uses gaz.ErrConfig* errors"
    - "ValidationError type is imported from gaz package"
  artifacts:
    - path: "config/validation.go"
      provides: "Config validation using gaz errors"
      contains: "gaz.ErrConfigValidation"
  key_links:
    - from: "config/*.go"
      to: "gaz/errors.go"
      via: "import and error/type references"
      pattern: "gaz\\.ErrConfig|gaz\\.ValidationError"
---

<objective>
Migrate the config package to use consolidated gaz errors.

Purpose: Remove config/errors.go as error source, all config errors now come from gaz/errors.go
Output: config package using gaz.ErrConfig* errors and gaz.ValidationError type
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/27-error-standardization/27-CONTEXT.md
@.planning/phases/27-error-standardization/27-01-SUMMARY.md
@gaz/errors.go
@config/errors.go
@config/manager.go
@config/validation.go
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update config package to use gaz errors</name>
  <files>config/manager.go, config/validation.go, config/viper/backend.go</files>
  <action>
Update all config package files to import gaz and use new error names. For each file:

1. Add import: `"github.com/petabytecl/gaz"` 
2. Replace error references:
   - `ErrConfigValidation` → `gaz.ErrConfigValidation`
   - `ErrKeyNotFound` → `gaz.ErrConfigNotFound`

3. Replace type references:
   - `ValidationError` → `gaz.ValidationError`
   - `FieldError` → `gaz.FieldError`
   - `NewValidationError(...)` → `gaz.NewValidationError(...)`
   - `NewFieldError(...)` → `gaz.NewFieldError(...)`

4. Update error wrapping to use "config: context: %w" format consistently.

Note: config package already has some "config: ..." prefixed errors, ensure consistency.
  </action>
  <verify>
Run `go build ./config/...` - should compile successfully
  </verify>
  <done>
All config/*.go files import gaz and use gaz.ErrConfig*, gaz.ValidationError, gaz.FieldError
  </done>
</task>

<task type="auto">
  <name>Task 2: Delete config/errors.go and update tests</name>
  <files>config/errors.go, config/*_test.go</files>
  <action>
1. Delete `config/errors.go` completely (all errors/types now in gaz/errors.go)

2. Update config test files:
   - Add `"github.com/petabytecl/gaz"` import where needed
   - Replace `ErrConfigValidation` → `gaz.ErrConfigValidation`
   - Replace `ErrKeyNotFound` → `gaz.ErrConfigNotFound`
   - Replace `ValidationError` → `gaz.ValidationError`
   - Update `errors.Is(err, ErrConfigValidation)` to `errors.Is(err, gaz.ErrConfigValidation)`

Files to check: config/validation_test.go, config/manager_test.go
  </action>
  <verify>
Run `go test ./config/...` - all tests should pass
  </verify>
  <done>
config/errors.go deleted, all config tests pass using gaz.ErrConfig* and gaz.ValidationError
  </done>
</task>

</tasks>

<verification>
1. `ls config/errors.go` returns "No such file" (deleted)
2. `go build ./config/...` passes
3. `go test ./config/...` passes
4. `grep -r "ErrConfigValidation\|ErrKeyNotFound" config/*.go` shows only gaz-prefixed references
</verification>

<success_criteria>
- config/errors.go is deleted
- All config package code uses gaz.ErrConfig* errors and gaz.ValidationError type
- All config tests pass
- No bare error references without gaz. prefix
</success_criteria>

<output>
After completion, create `.planning/phases/27-error-standardization/27-03-SUMMARY.md`
</output>
