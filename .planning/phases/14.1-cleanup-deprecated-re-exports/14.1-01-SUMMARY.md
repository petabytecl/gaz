---
phase: 14.1-cleanup-deprecated-re-exports
plan: 01
subsystem: api
tags: [cleanup, backward-compat, config, di, re-exports]

# Dependency graph
requires:
  - phase: 14-workers
    provides: Complete package extractions (di, config, worker)
provides:
  - Clean root gaz package API surface
  - DI APIs without deprecation (For, Resolve, Container)
  - Removed deprecated config re-exports
affects: [14.1-02, documentation, examples]

# Tech tracking
tech-stack:
  added: []
  patterns: [direct-subpackage-imports]

key-files:
  created: []
  modified: [errors.go, compat.go, config_manager.go, app.go, examples/config-loading/main.go]

key-decisions:
  - "Keep DI error aliases (ErrNotFound, etc.) as ergonomic conveniences"
  - "Remove ErrConfigValidation - users check config.ErrConfigValidation"
  - "Remove deprecation marker from NewContainer - it's a permanent convenience API"
  - "Update App.WithConfig to use config.Option directly"

patterns-established:
  - "Pattern 1: Users import gaz/config for config options"
  - "Pattern 2: Root gaz package only exposes core DI conveniences"

# Metrics
duration: 2min
completed: 2026-01-28
---

# Phase 14.1 Plan 01: Remove Deprecated Config Re-exports Summary

**Deleted deprecated config re-export files (options.go, config.go), cleaned up errors.go and compat.go, updated signatures to use config.Option directly**

## Performance

- **Duration:** 2 min
- **Started:** 2026-01-28T21:57:21Z
- **Completed:** 2026-01-28T21:59:39Z
- **Tasks:** 3
- **Files modified:** 7 (2 deleted, 5 modified)

## Accomplishments

- Deleted options.go containing deprecated ConfigOption alias and With* function re-exports
- Deleted config.go containing deprecated Defaulter and Validator type aliases
- Removed ErrConfigValidation alias from errors.go (users use config.ErrConfigValidation)
- Removed deprecation marker from NewContainer in compat.go (permanent API)
- Updated NewConfigManager and App.WithConfig to accept config.Option directly
- Fixed config-loading example to import gaz/config directly

## Task Commits

Each task was committed atomically:

1. **Task 1: Delete deprecated config re-export files** - `2a91467` (chore)
2. **Task 2: Update errors.go and compat.go** - `7886bb4` (refactor)
3. **Task 3: Update config_manager.go signature** - `4bbc3ce` (refactor)

## Files Created/Modified

- `options.go` - DELETED (contained ConfigOption, WithName, WithType, etc.)
- `config.go` - DELETED (contained Defaulter, Validator aliases)
- `errors.go` - Removed ErrConfigValidation, removed config import
- `compat.go` - Removed deprecation marker from NewContainer
- `config_manager.go` - Updated signature to use config.Option
- `app.go` - Updated WithConfig signature to use config.Option
- `examples/config-loading/main.go` - Updated to import gaz/config

## Decisions Made

1. **Keep DI error aliases** - ErrNotFound, ErrCycle, ErrDuplicate, etc. remain as ergonomic conveniences for users checking errors.Is()
2. **Remove ErrConfigValidation** - Users should use config.ErrConfigValidation directly for config-related errors
3. **Keep NewContainer without deprecation** - It's a permanent convenience API that delegates to di.New()
4. **Keep TypeName, typeName, Named, RegistrationBuilder, ResolveOption, ServiceWrapper** - All are useful API surface for DI operations

## Deviations from Plan

### Auto-fixed Issues

**1. [Rule 3 - Blocking] Fixed App.WithConfig signature**
- **Found during:** Task 3 (Update config_manager.go signature)
- **Issue:** App.WithConfig also used ConfigOption type alias which no longer exists
- **Fix:** Updated App.WithConfig signature to use config.Option directly
- **Files modified:** app.go
- **Verification:** go build ./... succeeds
- **Committed in:** 4bbc3ce (Task 3 commit)

**2. [Rule 3 - Blocking] Fixed config-loading example**
- **Found during:** Task 3 (Compile check)
- **Issue:** examples/config-loading/main.go used gaz.WithName, gaz.WithSearchPaths, gaz.WithEnvPrefix which no longer exist
- **Fix:** Updated imports to use gaz/config and changed to config.WithName, config.WithSearchPaths, config.WithEnvPrefix
- **Files modified:** examples/config-loading/main.go
- **Verification:** go build ./... succeeds
- **Committed in:** 4bbc3ce (Task 3 commit)

---

**Total deviations:** 2 auto-fixed (2 blocking)
**Impact on plan:** Both fixes necessary for compilation. No scope creep - examples will be fully updated in 14.1-02.

## Issues Encountered

None - all tasks completed successfully after handling blocking issues.

## User Setup Required

None - no external service configuration required.

## Next Phase Readiness

- Ready for 14.1-02-PLAN.md (Update tests and documentation to use config.* imports)
- May find more examples/tests using deprecated gaz.With* patterns
- No blockers

---
*Phase: 14.1-cleanup-deprecated-re-exports*
*Completed: 2026-01-28*
