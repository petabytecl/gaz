---
phase: 10-documentation-and-examples
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - example_test.go
  - example_lifecycle_test.go
  - example_config_test.go
autonomous: true

must_haves:
  truths:
    - "pkg.go.dev shows runnable examples for key functions"
    - "go test ./... runs all examples without failure"
    - "Examples demonstrate real API usage patterns"
  artifacts:
    - path: "example_test.go"
      provides: "Basic API examples for godoc"
      contains: "func Example"
    - path: "example_lifecycle_test.go"
      provides: "Lifecycle examples for godoc"
      contains: "OnStart"
    - path: "example_config_test.go"
      provides: "Config examples for godoc"
      contains: "ConfigManager"
  key_links:
    - from: "example_test.go"
      to: "container.go"
      via: "import and usage"
      pattern: "gaz.NewContainer"
---

<objective>
Create testable godoc examples that appear on pkg.go.dev and run via go test.

Purpose: Provide executable documentation that stays in sync with API.
Output: 3 example test files covering core DI, lifecycle, and configuration.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/10-documentation-and-examples/10-CONTEXT.md
@.planning/phases/10-documentation-and-examples/10-RESEARCH.md

# Source files for API reference
@app.go
@container.go
@registration.go
@lifecycle.go
@config_manager.go
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create example_test.go with core DI examples</name>
  <files>example_test.go</files>
  <action>
Create example_test.go in package gaz_test (black-box testing style).

Use import: `"github.com/petabytecl/gaz"`

**Required examples:**

1. `ExampleNew()` - Basic app creation and provider registration
   - Create app, register singleton, build, resolve
   - Output: service name or "built successfully"

2. `ExampleFor_singleton()` - Registering a singleton with For[T]
   - Use Container API: gaz.NewContainer(), gaz.For[T](c).Singleton()
   - Resolve twice, show same instance

3. `ExampleFor_transient()` - Registering a transient service
   - Use For[T](c).Transient()
   - Resolve twice, show different instances

4. `ExampleResolve()` - Resolving a service
   - Register and resolve with type safety
   - Handle error case in example

5. `ExampleApp_ProvideSingleton()` - Method-level example
   - Show dependency injection: service depends on another service
   - Factory function receives Container for resolving dependencies

6. `ExampleContainer_Build()` - Container build process
   - Show eager services instantiated at build time

**Format for each:**
```go
func ExampleFunctionName() {
    // setup code
    // ...
    fmt.Println(result)
    // Output: expected output
}
```

Every example MUST have `// Output:` comment for go test to verify it.

Define helper types in the file as needed (e.g., MyService struct).
  </action>
  <verify>go test -v -run Example ./... 2>&1 | head -30</verify>
  <done>example_test.go exists, all examples pass go test</done>
</task>

<task type="auto">
  <name>Task 2: Create lifecycle and config example files</name>
  <files>example_lifecycle_test.go, example_config_test.go</files>
  <action>
**example_lifecycle_test.go:**
Whole-file example demonstrating lifecycle hooks.

Package: gaz_test

Define types in file:
```go
type Server struct {
    started bool
}

func (s *Server) OnStart(ctx context.Context) error {
    s.started = true
    return nil
}

func (s *Server) OnStop(ctx context.Context) error {
    s.started = false
    return nil
}
```

Examples:
1. `Example_lifecycle()` - Basic lifecycle demonstration
   - Register Server, build, show that lifecycle hooks exist
   - Note: Can't easily show async start/stop in example output
   - Focus on showing the pattern

2. `Example_lifecycleOrder()` - Startup order with dependencies
   - Service A depends on Service B
   - Show that B starts before A

**example_config_test.go:**
Config loading and validation examples.

Define config types:
```go
type AppConfig struct {
    Port  int    `mapstructure:"port" validate:"required,min=1,max=65535"`
    Debug bool   `mapstructure:"debug"`
}
```

Examples:
1. `ExampleConfigManager()` - Basic config manager usage
   - Create ConfigManager with defaults
   - Show loading config

2. `ExampleNewConfigManager()` - Full config setup
   - WithName, WithSearchPaths, WithDefaults
   - Note: File loading hard to demo in example, focus on API

3. `Example_validation()` - Config validation with tags
   - Show validation error for invalid config
   - Or show successful validation

Keep examples simple and focused. Use `// Output:` for testability.
Output can be simple strings if async behavior makes exact output unpredictable.
  </action>
  <verify>go test -v -run Example ./... 2>&1 | grep -E "(PASS|FAIL|Example)"</verify>
  <done>Both example files exist, all examples pass go test</done>
</task>

</tasks>

<verification>
```bash
# All example files exist
ls example_test.go example_lifecycle_test.go example_config_test.go

# All examples pass
go test -v -run Example ./... 2>&1 | tail -10

# Count examples (should be at least 8)
grep -c "func Example" example_*.go | awk -F: '{sum+=$2} END {print "Total examples:", sum}'
```
</verification>

<success_criteria>
1. Three example test files exist in package root
2. All examples have `// Output:` comments
3. `go test -run Example ./...` passes with no failures
4. Examples demonstrate key APIs: New, For, Resolve, lifecycle hooks, ConfigManager
5. Examples use black-box testing style (package gaz_test)
</success_criteria>

<output>
After completion, create `.planning/phases/10-documentation-and-examples/10-03-SUMMARY.md`
</output>
