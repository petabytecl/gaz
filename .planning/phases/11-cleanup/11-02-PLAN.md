---
phase: 11-cleanup
plan: 02
type: execute
wave: 2
depends_on: ["11-01"]
files_modified:
  - examples/basic/main.go
  - examples/cobra-cli/main.go
  - examples/config-loading/main.go
  - examples/http-server/main.go
  - examples/lifecycle/main.go
  - examples/modules/main.go
  - README.md
  - CHANGELOG.md
autonomous: true

must_haves:
  truths:
    - "All example applications compile and run"
    - "All examples use For[T]() registration pattern exclusively"
    - "Examples demonstrate comprehensive gaz features (DI, config, lifecycle, modules)"
    - "README reflects new patterns and example structure"
    - "CHANGELOG documents deprecated API removal"
  artifacts:
    - path: "examples/basic/main.go"
      provides: "Basic DI example"
      contains: "For["
    - path: "examples/lifecycle/main.go"
      provides: "Lifecycle management example"
      contains: "For["
    - path: "examples/config-loading/main.go"
      provides: "Configuration example"
      contains: "For["
    - path: "README.md"
      provides: "Updated documentation"
      contains: "For["
    - path: "CHANGELOG.md"
      provides: "v2.0 changelog entry"
      contains: "BREAKING"
  key_links:
    - from: "examples/*/main.go"
      to: "registration.go"
      via: "For[T]() registration"
      pattern: "gaz\\.For\\["
---

<objective>
Rewrite all example applications to use the generic fluent For[T]() registration pattern, update README and CHANGELOG, and perform full codebase lint/format pass.

Purpose: Provide comprehensive, up-to-date examples that showcase all gaz features using the modern API.
Output: Working examples, updated documentation, clean codebase.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/11-cleanup/11-CONTEXT.md
@.planning/phases/11-cleanup/11-01-SUMMARY.md

# Example files to update
@examples/basic/main.go
@examples/lifecycle/main.go
@registration.go
</context>

<tasks>

<task type="auto">
  <name>Task 1: Rewrite all examples with For[T]() pattern</name>
  <files>examples/basic/main.go, examples/cobra-cli/main.go, examples/config-loading/main.go, examples/http-server/main.go, examples/lifecycle/main.go, examples/modules/main.go</files>
  <action>
Rewrite each example to use For[T]() registration pattern instead of deprecated methods.

**examples/basic/main.go:**
- Replace `app.ProvideSingleton(func(c *gaz.Container) (*Greeter, error) {...})` with:
  ```go
  if err := gaz.For[*Greeter](app.Container()).Provider(func(c *gaz.Container) (*Greeter, error) {
      return &Greeter{name: "World"}, nil
  }); err != nil {
      log.Fatal(err)
  }
  ```
- Keep example simple and focused on basic DI

**examples/lifecycle/main.go:**
- Replace `app.ProvideSingleton(...)` with `gaz.For[*Server](app.Container()).Provider(...)`
- Ensure Starter/Stopper interfaces are demonstrated

**examples/cobra-cli/main.go:**
- Replace `app.ProvideInstance(config)` with `gaz.For[*Config](app.Container()).Instance(config)`
- Keep the existing For[T]() call for Server (already correct)
- Ensure Cobra integration is clearly demonstrated

**examples/http-server/main.go:**
- Replace `app.ProvideInstance(config)` with `gaz.For[*Config](app.Container()).Instance(config)`
- Replace `app.ProvideSingleton(...)` for Handler with For[T]() pattern
- Keep existing For[T]() call for Server

**examples/config-loading/main.go:**
- Update to use For[T]() if any deprecated patterns exist
- Ensure config loading with WithConfig() is demonstrated

**examples/modules/main.go:**
- Already uses For[T]() pattern, verify no deprecated APIs remain
- Ensure module pattern is clearly demonstrated

Make examples comprehensive:
- Add comments explaining key patterns
- Demonstrate error handling properly
- Show dependency resolution chain where applicable
  </action>
  <verify>
Run `go build ./examples/...` to confirm all examples compile.
Run each example briefly: `timeout 2 go run ./examples/basic/` (expect graceful output or timeout).
Run `grep -r "ProvideSingleton\|ProvideTransient\|ProvideEager\|ProvideInstance" examples/` returns no matches.
  </verify>
  <done>
All examples compile, run without errors, and use For[T]() pattern exclusively.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update documentation and run lint/format</name>
  <files>README.md, CHANGELOG.md</files>
  <action>
**Update README.md:**
1. Replace all code examples using deprecated APIs with For[T]() equivalents
2. Update the "Quick Start" section to show For[T]() registration
3. Update any "Features" or "Usage" sections
4. Ensure example references point to correct example directories
5. Keep README concise but comprehensive

Example transformation for README:
```go
// OLD (remove)
app.ProvideSingleton(NewDatabase).
    ProvideSingleton(NewUserService)

// NEW (add)
gaz.For[*Database](app.Container()).Provider(NewDatabase)
gaz.For[*UserService](app.Container()).Provider(NewUserService)
```

**Create/Update CHANGELOG.md:**
Add v2.0.0 entry with:
```markdown
## [2.0.0] - 2026-01-XX

### Breaking Changes

- Removed `NewApp()` function - use `gaz.New()` instead
- Removed `AppOption` type - use `gaz.Option` instead
- Removed `App.ProvideSingleton()` - use `gaz.For[T](c).Provider(fn)`
- Removed `App.ProvideTransient()` - use `gaz.For[T](c).Transient().Provider(fn)`
- Removed `App.ProvideEager()` - use `gaz.For[T](c).Eager().Provider(fn)`
- Removed `App.ProvideInstance()` - use `gaz.For[T](c).Instance(value)`
- Removed reflection-based service wrappers (internal)

### Migration

All registration now uses the type-safe generic fluent API:

```go
// Before
app.ProvideSingleton(NewDatabase)

// After
gaz.For[*Database](app.Container()).Provider(NewDatabase)
```

### Improved

- Examples rewritten to showcase all features comprehensively
- Updated documentation to reflect new API
```

**Run lint/format:**
1. Run `go fmt ./...`
2. Run `goimports -w .` (if available)
3. Run `golangci-lint run ./...` and fix any issues
4. Ensure consistent code style across entire codebase
  </action>
  <verify>
Run `go fmt ./...` shows no changes (already formatted).
Run `golangci-lint run ./...` passes with no errors.
Check CHANGELOG.md exists and contains v2.0.0 entry.
Check README.md contains For[T]() examples.
  </verify>
  <done>
README updated with new API examples, CHANGELOG has v2.0 breaking changes documented, codebase passes lint/format checks.
  </done>
</task>

</tasks>

<verification>
1. `go build ./...` succeeds (including examples)
2. `go test ./...` succeeds
3. `golangci-lint run ./...` passes
4. All examples use For[T]() pattern (verified by grep)
5. README contains For[T]() examples
6. CHANGELOG has v2.0 breaking changes section
</verification>

<success_criteria>
- All examples compile and demonstrate modern For[T]() pattern
- README reflects new API with correct examples
- CHANGELOG documents all breaking changes
- Codebase passes lint/format checks
- CLN-11 requirement satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/11-cleanup/11-02-SUMMARY.md`
</output>
