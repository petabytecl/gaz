---
phase: 19
plan: 02
type: execute
wave: 1
depends_on: []
files_modified: [command.go, cobra.go, cobra_test.go]
autonomous: true
must_haves:
  truths:
    - "CLI positional arguments are accessible via DI"
    - "gaz.GetArgs(container) returns the arguments slice"
    - "CommandArgs struct is available in the container"
  artifacts:
    - path: "command.go"
      provides: "CommandArgs struct and GetArgs helper"
    - path: "cobra.go"
      provides: "Registration logic in bootstrap"
  key_links:
    - from: "cobra.go"
      to: "command.go"
      via: "Dependency injection of CommandArgs"
---

<objective>
Enable access to CLI arguments (positional args) from within the Dependency Injection container.
This allows services to access command-line inputs like file paths or IDs passed after the command.

Purpose: Enhance CLI integration flexibility.
Output: `CommandArgs` type available in DI and helper function to retrieve it.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@cobra.go
</context>

<tasks>

<task type="auto">
  <name>Task 1: Define CommandArgs type and helper</name>
  <files>command.go</files>
  <action>
    Create `command.go` in the root package.
    Define `type CommandArgs struct { Command *cobra.Command; Args []string }`.
    Implement `func GetArgs(c di.Container) []string` helper that resolves `*CommandArgs` and returns Args.
    Handle case where `CommandArgs` is not present (return nil/empty safely).
  </action>
  <verify>
    Create a temporary test file to verify struct definition and helper signature.
  </verify>
  <done>
    `CommandArgs` struct exists and `GetArgs` function is implemented.
  </done>
</task>

<task type="auto">
  <name>Task 2: Inject CommandArgs in bootstrap</name>
  <files>cobra.go</files>
  <action>
    Modify `(a *App) bootstrap` function in `cobra.go`.
    Construct `&CommandArgs{Command: cmd, Args: args}` using the bootstrap arguments.
    Register this instance into the container using `gaz.For[*CommandArgs](a.container).Instance(argsInstance)`.
    Ensure this happens BEFORE `a.container.Build()`.
  </action>
  <verify>
    go test -v cobra_test.go
  </verify>
  <done>
    `CommandArgs` is registered during app bootstrap.
  </done>
</task>

<task type="auto">
  <name>Task 3: Verify with integration test</name>
  <files>cobra_test.go</files>
  <action>
    Add a test case in `cobra_test.go` (or `cobra_integration_test.go`) that:
    1. Creates a dummy Cobra command.
    2. Runs an App with a simple service that depends on `*CommandArgs`.
    3. Verifies the service receives the correct args passed to the command.
    4. Also verify `gaz.GetArgs(container)` works within an `Invoke` block.
  </action>
  <verify>
    go test -v cobra_test.go
  </verify>
  <done>
    Integration test confirms args are passable and retrievable.
  </done>
</task>

</tasks>

<verification>
Run all tests in current directory to ensure no regressions in Cobra integration.
`go test -v .`
</verification>

<success_criteria>
- [ ] `CommandArgs` struct defined
- [ ] `bootstrap` registers args
- [ ] Integration test passes with real Cobra command execution
</success_criteria>

<output>
After completion, create `.planning/phases/19-interface-auto-detection-cli-args/19-02-SUMMARY.md`
</output>
